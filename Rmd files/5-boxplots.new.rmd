---
title: "Salamander eye scaling and investment - boxplots"
author: "Nicole Bednarik & Katie Thomas"
date: 9 September 2022
output:
  html_document:
    theme: flatly
    toc: TRUE
    toc_float: TRUE
    code_fold: show
---

```{r setup, include = FALSE}

# Load package libraries
library(plyr)
library(caper)
library(plotly)
library(kableExtra)
library(gridExtra)
library(ggimage)
library(grid)
library(gtable)
library(cowplot)
library(knitr)
library(tidyverse)

# Markdown settings
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.height = 4.5, fig.width=8)

```

# Data

First we import our tidied salamander morphology & trait binary dataset with the residuals of a cornea ~ cube root of mass PGLS as a column.

```{r load-data}

# Import tidied salamander eye size and trait data
sal.res <- data.frame(read.csv("../Data/salamanders_residuals_binary.csv", header=TRUE, na.strings=c("", "NA", " ","<1")))
sal.res.2 <- data.frame(read.csv("../Data/salamanders_residuals_updated.csv", header=TRUE, na.strings=c("", "NA", " ", "<1")))

# Quick look at data structure
str(sal.res)
str(sal.res.2)

sal.res <- sal.res[-c(35:460)]

```
#Plots

Next, we make boxplots of how eye size and relative eye size (represented by the PGLS residuals)compare across salamander ecological traits.

##Aquatic

```{r}
#boxplot of cornea diameter vs aquatic ecology
aquatic.abs <- ggplot(data = filter(sal.res, !is.na(Aquatic)), aes(x = Aquatic, y = cor_av)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Mean cornea diameter (mm)") +
  xlab("Aquatic ecology") +
  theme(legend.position = "none")

#print plot
aquatic.abs

```
```{r}
#boxplot of pgls residuals vs. aquatic ecology (relative eye size)
aquatic.rel <- ggplot(data = filter(sal.res, !is.na(Aquatic)), aes(x = Aquatic, y = pglsres.cdmass)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Relative cornea diameter (PGLS residuals)") +
  xlab("Aquatic ecology") +
  theme(legend.position = "none")

#print plot
aquatic.rel

```

##Semiaquatic
```{r}
#boxplot of cornea diameter vs semiaquatic ecology
semiaquatic.abs <- ggplot(data = filter(sal.res, !is.na(Semiaquatic)), aes(x = Semiaquatic, y = cor_av)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Mean cornea diameter (mm)") +
  xlab("Semiaquatic ecology") +
  theme(legend.position = "none")

#print plot
semiaquatic.abs

```
```{r}
#boxplot of pgls residuals vs. semiaquatic ecology (relative eye size)
semiaquatic.rel <- ggplot(data = filter(sal.res, !is.na(Semiaquatic)), aes(x = Semiaquatic, y = pglsres.cdmass)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Relative cornea diameter (PGLS residuals)") +
  xlab("Semiaquatic ecology") +
  theme(legend.position = "none")

#print plot
semiaquatic.rel

```

##Terrestrial
```{r}
#boxplot of cornea diameter vs terrestrial ecology
terrestrial.abs <- ggplot(data = filter(sal.res, !is.na(Terrestrial)), aes(x = Terrestrial, y = cor_av)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Mean cornea diameter (mm)") +
  xlab("Terrestrial ecology") +
  theme(legend.position = "none")

#print plot
terrestrial.abs

```

```{r}
#boxplot of pgls residuals vs. terrestrial ecology (relative eye size)
terrestrial.rel <- ggplot(data = filter(sal.res, !is.na(Terrestrial)), aes(x = Terrestrial, y = pglsres.cdmass)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Relative cornea diameter (PGLS residuals)") +
  xlab("Terrestrial ecology") +
  theme(legend.position = "none")

#print plot
terrestrial.rel

```

##Scansorial
```{r}
#boxplot of cornea diameter vs scansorial ecology
scansorial.abs <- ggplot(data = filter(sal.res, !is.na(Scansorial)), aes(x = Scansorial, y = cor_av)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Mean cornea diameter (mm)") +
  xlab("Scansorial ecology") +
  theme(legend.position = "none")

#print plot
scansorial.abs

```

```{r}
#boxplot of pgls residuals vs. scansorial ecology (relative eye size)
scansorial.rel <- ggplot(data = filter(sal.res, !is.na(Scansorial)), aes(x = Scansorial, y = pglsres.cdmass)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Relative cornea diameter (PGLS residuals)") +
  xlab("Scansorial ecology") +
  theme(legend.position = "none")

#print plot
scansorial.rel

```


##Subfossorial
```{r}
#boxplot of cornea diameter vs subfossorial ecology
subfossorial.abs <- ggplot(data = filter(sal.res, !is.na(Subfossorial)), aes(x = Subfossorial, y = cor_av)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Mean cornea diameter (mm)") +
  xlab("Subfossorial ecology") +
  theme(legend.position = "none")

#print plot
subfossorial.abs

```

```{r}
#boxplot of pgls residuals vs. subfossorial ecology (relative eye size)
subfossorial.rel <- ggplot(data = filter(sal.res, !is.na(Subfossorial)), aes(x = Subfossorial, y = pglsres.cdmass)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Relative cornea diameter (PGLS residuals)") +
  xlab("Subfossorial ecology") +
  theme(legend.position = "none")

#print plot
subfossorial.rel

```

##Cave_dwelling
```{r}
#boxplot of cornea diameter vs cave dwelling ecology
cave_dwelling.abs <- ggplot(data = filter(sal.res, !is.na(Cave_dwelling)), aes(x = Cave_dwelling, y = cor_av)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Mean cornea diameter (mm)") +
  xlab("Cave dwelling ecology") +
  theme(legend.position = "none")

#print plot
cave_dwelling.abs

```

```{r}
#boxplot of pgls residuals vs. cave dwelling ecology (relative eye size)
cave_dwelling.rel <- ggplot(data = filter(sal.res, !is.na(Cave_dwelling)), aes(x = Cave_dwelling, y = pglsres.cdmass)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Relative cornea diameter (PGLS residuals)") +
  xlab("Cave dwelling ecology") +
  theme(legend.position = "none")

#print plot
cave_dwelling.rel
```

##Eye size and investment across adult habitats
```{r}
#boxplot of cornea diameter vs adult habitat
adult_habitat.abs <- ggplot(data = filter(sal.res.2, !is.na(Adult.Habitat)), aes(x = Adult.Habitat, y = cor_av, col=Adult.Habitat)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Mean cornea diameter (mm)") +
  xlab("Adult Habitat") +
  theme(legend.position = "none")

#print plot
adult_habitat.abs

```
```{r}
#boxplot of pgls residuals vs. adult habitat (relative eye size)
adult_habitat.rel <- ggplot(data = filter(sal.res.2, !is.na(Adult.Habitat)), aes(x = Adult.Habitat, y = pglsres.cdmass, col=Adult.Habitat)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Relative cornea diameter (PGLS residuals)") +
  xlab("Adult Habitat") +
  theme(legend.position = "none")

#print plot
adult_habitat.rel
```

##Eye size and investment relationship with development type

```{r}
#boxplot of cornea diameter vs development
development.abs <- ggplot(data = filter(sal.res.2, !is.na(Development)), aes(x = Development, y = cor_av, col=Development)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Mean cornea diameter (mm)") +
  xlab("Development") +
  theme(legend.position = "none")

#print plot
development.abs

```

```{r}
#boxplot of pgls residuals vs. development (relative eye size)
development.rel <- ggplot(data = filter(sal.res.2, !is.na(Development)), aes(x = Development, y = pglsres.cdmass, col=Development)) +
  geom_boxplot(notch = FALSE, outlier.shape = NA) +
  stat_summary(fun.y = mean, colour="black", geom="point", 
               shape=18, size=3, show_guide = FALSE) +
  geom_jitter(aes(text = Genus_Species), 
              shape = 19, size = 1.3, alpha = 0.3, position = position_jitter(0.15)) +
  theme(text = element_text(size=14), panel.background = element_blank(), axis.line = element_line(colour = "black")) +
  theme(axis.text = element_text(angle = 0, size = 9)) +
  ylab("Relative cornea diameter (PGLS residuals)") +
  xlab("Development") +
  theme(legend.position = "none")

#print plot
development.rel
```
